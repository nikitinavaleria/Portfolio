# Oil wells
# Выбор локации для скважины

Нужно решить, где бурить новую скважину. Предоставлены пробы нефти в трёх регионах: в каждом 10 000 месторождений, где измерили качество нефти и объём её запасов. Необходимо построить модель машинного обучения, которая поможет определить регион, где добыча принесёт наибольшую прибыль. Также необходимо проанализировать возможную прибыль и риски техникой Bootstrap.

**Шаги для выбора локации:**

В избранном регионе ищут месторождения, для каждого определяют значения признаков;

Строят модель и оценивают объём запасов;

Выбирают месторождения с самым высокими оценками значений. Количество месторождений зависит от бюджета компании и стоимости разработки одной скважины;

Прибыль равна суммарной прибыли отобранных месторождений.

**Описание данных**

 - id — уникальный идентификатор скважины;
 - f0, f1, f2 — три признака точек (неважно, что они означают, но сами признаки значимы);
 - product — объём запасов в скважине (тыс. баррелей).

**Условия задачи:**

1) Для обучения модели подходит только линейная регрессия (остальные — недостаточно предсказуемые).

2) При разведке региона исследуют 500 точек, из которых с помощью машинного обучения выбирают 200 лучших для разработки.

3) Бюджет на разработку скважин в регионе — 10 млрд рублей.

4) При нынешних ценах один баррель сырья приносит 450 рублей дохода. Доход с каждой единицы продукта составляет 450 тыс. рублей, поскольку объём указан в тысячах баррелей.

5) После оценки рисков нужно оставить лишь те регионы, в которых вероятность убытков меньше 2.5%. Среди них выбирают регион с наибольшей средней прибылью.

6) Данные синтетические: детали контрактов и характеристики месторождений не разглашаются.

## **Выводы по проекту**

1) Загрузка и подготовка данных

Полученные исходные данные были для начала предобработаны, проверены на пропуски, выбросы, а также получено первое представление о распределении данных: получены гистограммы и матрицы корреляций.

Далее данные были подготовлены к дальнейшему обучению модели линейной регрессии, они были разделены на тренировочную и валидационную выборки и стандартизированы.

Для всех трех скважин было замечено, что в метриках f данные не всегда распределны нормально и сильно выбиваются. Далее это может способствовать увеличению среднеквадратической ошибки в исследуемом признаке. Также замечена сильная корреляция между метрикой f2 и целевым признаком. Это может говорить о наибольшем вкладе именно этой метрики.

2) Обучение и проверка модели

На данном этапе была обучена модель линейной регрессии. Для каждой скважины было получено стандартное отклонение и средний запас сырья в скважине

RMSE модели линейной регрессии на валидационной выборке скважины 0: 37.5794217150813 Средний запас предсказанного сырья скважины 0: 92.59256778438035

RMSE модели линейной регрессии на валидационной выборке скважины 1: 0.893099286775617 Средний запас предсказанного сырья скважины 1: 68.728546895446

RMSE модели линейной регрессии на валидационной выборке скважины 2: 40.02970873393434 Средний запас предсказанного сырья скважины 2: 94.96504596800489

3) Подготовка к расчёту прибыли

На данном этапе был рассчитан достаточный объём сырья для безубыточной разработки новой скважины: 111

Если сравнивать это значение с предыдущим пунктом, можно заметить, что средний запас по всей скважине меньше, чем достаточный объем, поэтому нужные скважины необходимо точнее выбирать.

4) Расчёт прибыли и рисков

На данном этапе были написаны функции для расчётв прибыли и рисков, которые применялись в следующем этапе.

5) Оценка рисков и прибыли для каждого региона

Здесь была применена техника Bootstrap с 1000 выборок, для нахождения распределения прибыли.Найдена среднюю прибыль для каждой скважины, 95%-й доверительный интервал и риск убытков. Таким образом для каждой скважины:

**Скважина 0:**

Средняя прибыль: 425938527

2,5%-квантиль: -102090095

97,5%-квантиль: 947976353

Доля рисков для скважины 0: 6.0 %

**Скважины 1**

Средняя прибыль: 518259494

2,5%-квантиль: 128123231

97,5%-квантиль: 953612982

Доля рисков для скважины 1: 0.3 %

**Скважина 2**

Средняя прибыль: 420194005

2,5%-квантиль: -115852609

97,5%-квантиль: 989629940

Доля рисков для скважины 2: 6.2 %

### **Рекомендации**

Наилучшей скважининой является скважина 1. Она имеет наименьший процент рисков - 0.3%. Остальные скважины имеют процент больший, чем 2.5%. Скважина 1 показывает среднее значение прибыли 518 259 494 рублей.
