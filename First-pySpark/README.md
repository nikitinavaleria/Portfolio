# First pySpark
# Предсказание стоимости жилья

В проекте была обучена модель линейной регрессии на данных о жилье в Калифорнии в 1990 году. На основе данных нужно предсказать медианную стоимость дома в жилом массиве. Для оценки качества модели использовались метрики RMSE, MAE и R2.

## Анализ результатов

В данной работе были проанализированы данные о жилье в Калифорнии в 1990 году. Были удалены пропуски, данные были предобработаны, проверены, закодированы и приведены к необходимому формату для дальнейшей работы.

Далее были построены модели линейной регрессии на двух выборках: на полных данных и только числовых данных. Были получены следующие результаты:

*На тренировочной выборке для полных данных:* 
 - RMSE: 68839.09
 - r2: 0.64
 - MAE: 49832.72

*На тренировочной выборке для числовых данных:* 
 - RMSE: 69780.092
 - r2: 0.632
 - MAE: 50944.50

*На тестовой выборке для полных данных:* 
 - R Squared (R2) on test data = 0.65
 - Root Mean Squared Error (RMSE) on test data = 68486.7
 - Mean Absolute Error (MAE) on test data = 49867

*На тестовой выборке для числовых данных*: 
 - R Squared (R2) on test data = 0.64
 - Root Mean Squared Error (RMSE) on test data = 69212.9
 - Mean Absolute Error (MAE) on test data = 50866.6

Коэффициент детерминации: единица минус отношение средней квадратичной ошибки модели к средней квадратичной ошибке среднего значения тестовой выборки. Собственно единица минус отношение (RMSE)2 к дисперсии реальных значений выборки. R2 показывает, что ближе к реальным данным: наши предсказания или просто среднее по выборке. В нашем случае метрика лежит от 0 до 1, что означает, что RMSE меньше, чем просто среднее по выборке. Значит, модель имеет право на существование.

MAE сообщает нам среднюю абсолютную разницу между прогнозируемыми значениями и фактическими значениями в наборе данных. Чем ниже MAE, тем лучше модель соответствует набору данных.

RMSE - квадратный корень из средней квадратичной разницы между прогнозируемыми значениями и фактическими значениями в наборе данных. Чем ниже RMSE, тем лучше модель соответствует набору данных.

В данном случае RMSE важнее, потому что он более чувствителен к наблюдениям, которые далеки от среднего, потому что стоимость разнится довольно сильно, это можно наблюдать в описательной табличке в начале анализа. Стандартное отклонение в датасете 115395. Также видно, что для всех моделей видна разница между MAE и RMSE.

Таким образом линейная регрессия показала лучшие результаты для полной выборки, включащую в себя категориальные признаки. Более того, метрики на тесте не сильно отличаются от метрик на трейне, что говорит о том, что модель не переобучена и хорошо показывает себя на новых данных.
