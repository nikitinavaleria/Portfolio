# Bank clients
# Отток клиентов

**Цель:** Анализ оттока клиентов из "Бета-Банка" и создание модели, определяющей, уйдет клиент или нет.


**Задачи:** Построение модели с предельно болшим значением F1-меры и лучшим значением AUC-ROC на основе данных о поведении клиентов и расторжении договоров с банком


**Источник данных:** [https://www.kaggle.com/barelydedicated/bank-customer-churn-modeling](https://www.kaggle.com/barelydedicated/bank-customer-churn-modeling)

## Общие выводы
Данная работа была посвящена анализу оттока клиентов юанка. Исходные данные представляли собой датасет с данными, примерно 10000 строк. В одном столбце Тenure(сколько лет человек клиент банка) были обнаружены пропуски. Часть пропусков была заполнена медианным значением величины относительно каждого возраста. Пропуски в редковстречаемых категориях возраста были удалены, пропуски составили 160 строк, в результате чего количество элементов было сокращено с 10000 до 9840.
Данные были проверены на выбросы и аномальные значения. Также данные были проверены на первичные корреляции с помощью матрицы корреляций. В данных был обнаружен дисбаланс классов.

Для дальнейшего построения моделей машинного обучения данные были разделены на обучающую, валидационную и тренировочную выборки в отношении 60/20/20. Далее данные были подвержены порядковому кодированию для корректной работы алгоритмов с категориальными данными. Таким образом категориальные данные были превпащены в количественные. Далее данные были стандартизированны для корректного обучения моделей.

Поскольку в данных был обнаружен дисбаланс классов, было принято решение попробовать 4 варианта данных:

1) данные с дисбалансом без балансировки

2) данные с взвешенными классами

3) данные с увеличенной выборкой

4) данные с уменьшенной выборкой

Для каждого варианта были построены 3 модели машинного обучения, а именно модели дерева решений, случайного леса и логистической регрессии.В работе приведена сравнительная табличка результатов для каждой модели.

Таким образом лучшей моделью стал **случайный лес с увеличенной выборкой с количеством деревьев равным 100, глубиной 13. При пороге 0.45 метрика f1 равняется 0.642, а значение auc-roc 0.857 на валидационных данных**. Далее было принято решение тестировать именно эту модель

Модель случайного леса показала следующие результаты на тестовых данных:

Порог = 0.45

Точность = 0.588,

Полнота = 0.592,

f1 = 0.590

auc-roc = 0.831

**Результаты и рекомендации**

Для поднятия качества необходимо увеличить собранную статистику и попробовать новые методы машинного обучения. По факту полученная точность близка к случайной.
